import{d as q,a as m,r as z,l as Q,b as f,o as i,c as C,e as c,j as d,q as v,O as b,P as O,I as h,n as G,u as E,t as H,Q as J,i as K,v as W,R as X,g as w,k as Y,S as Z,_ as x}from"./index.1e787b1d.js";import{u as ee,C as se,S as te,a as oe,V as ne,R as ae,b as re,g as ce,c as le,r as ue,d as ie,e as de,f as he}from"./index.7c74626f.js";import{R as pe}from"./index.57eaae27.js";import{M as p,D as me}from"./request.531db72e.js";const _e={class:"records"},fe={class:"fns"},ve={class:"top-options"},we={class:"select-suitations"},ge={class:"resource-content"},ye=["onClick"],Re={class:"outer-container"},Ce={class:"content"},be=q({__name:"my-resources",setup(Ee){const k=ee();let g=k.getRecordFromMap({});const a=m([]),n=m([]),u=m({show:!1,id:0,type:"r",title:""}),y=z(!1),r=m({show:!1,id:0,type:"r",initName:"",order:0}),D=async()=>{a.splice(0,a.length),n.splice(0,n.length);try{const s=await ce();a.push(...s.data.data),n.push(...Array(a.length).fill(!1))}catch(s){console.log("err",s)}};D();const S=Q(()=>n.reduce((s,e)=>e?s+1:s,0)),F=s=>()=>{n[s]=!n[s]},I=()=>{S.value!==n.length?n.forEach((s,e)=>{n[e]=!0}):n.forEach((s,e)=>{n[e]=!1})},M=()=>{n.forEach((s,e)=>{s===!0&&(n[e]=!1)})},$=(s,e)=>{const o={name:Z,params:{sId:s}};k.addRecordToMap({sId:s},[...g,{path:o,text:e}]),Y.push(o)},_=m({show:!1}),A=s=>{le(0,s).then(e=>{e.data.code=="200"&&(p("info",e.data.msg),D())}).catch(e=>{console.log("createResource error",e)}).finally(()=>{_.show=!1})},B=s=>{p("error","web\u7AEF\u6682\u4E0D\u652F\u6301\u4E0B\u8F7D\u8D44\u6E90\u529F\u80FD")},P=(s,e)=>{me("warning",{title:"\u786E\u5B9A\u5220\u9664\u5417",content:"10\u5929\u5185\u53EF\u4EE5\u4ECE\u56DE\u6536\u7AD9\u64A4\u9500",positiveText:"\u786E\u5B9A",negativeText:"\u53D6\u6D88",onPositiveClick:()=>{he(s).then(o=>{a.splice(e,1),p("success",o.data.msg)}).catch(o=>{console.log("delete err",o)})}})},U=s=>{ue(r.id,s).then(e=>{a[r.order].sName=s,p("success",e.data.msg)}).catch(e=>{}).finally(()=>{r.show=!1})},L=async(s,e)=>{try{const o=await ie(s);o.data.msg==="\u516C\u5F00\u6210\u529F"?a[e].isPublic=2:a[e].isPublic=1,p("success",o.data.msg)}catch(o){console.log("resourceLock error",o)}},T=async(s,e)=>{try{const o=await de(s);o.data.msg==="\u6536\u85CF\u6210\u529F"?a[e].isCollection=!0:a[e].isCollection=!1,p("success",o.data.msg)}catch(o){console.log("resourceCollect error",o)}};return(s,e)=>{const o=f("router-link"),V=f("n-breadcrumb-item"),j=f("n-breadcrumb"),N=f("svg-icon");return i(),C(b,null,[c("header",null,[c("div",_e,[d(j,{separator:">"},{default:v(()=>[(i(!0),C(b,null,O(E(g),(t,l)=>(i(),h(V,{key:l},{default:v(()=>[d(o,{to:t.path,class:G(["breadcrumb-route",[l===E(g).length-1?"active":"no-active"]])},{default:v(()=>[c("span",null,H(t.text),1)]),_:2},1032,["to","class"])]),_:2},1024))),128))]),_:1})]),c("div",fe,[d(N,{className:"icon-sousuo",class:"search-icon",onClick:e[0]||(e[0]=t=>y.value=!0)}),d(se,{type:"resource",onOnNewResource:e[1]||(e[1]=t=>_.show=!0),topest:""})])]),c("main",null,[c("div",ve,[c("div",we,[d(te,{"all-count":a.length,"select-count":E(S),"handle-select":I,show:a.length!==0},null,8,["all-count","select-count","show"])])]),c("div",ge,[c("div",{class:"absolute",onClick:J(M,["stop"])},[c("div",Re,[c("div",Ce,[(i(!0),C(b,null,O(a,(t,l)=>(i(),h(pe,X({key:t.sId},t,{hasSelect:n[l],handleSelect:F(l),onClick:R=>$(t.sId,t.sName),onOnDownload:B,onOnDetails:()=>{u.show=!0,u.id=t.sId,u.type="r",u.title=t.sName},onOnDelete:R=>P(t.sId,l),onOnRename:()=>{r.show=!0,r.type="r",r.id=t.sId,r.initName=t.sName,r.order=l},onOnPublic:R=>L(t.sId,l),onOnCollect:R=>T(t.sId,l)}),{icon:v(()=>[K(d(N,{className:"icon-dui"},null,512),[[W,n[l]]])]),_:2},1040,["hasSelect","handleSelect","onClick","onOnDetails","onOnDelete","onOnRename","onOnPublic","onOnCollect"]))),128))])])],8,ye)])]),_.show?(i(),h(oe,{key:0,"onUpdate:show":e[2]||(e[2]=t=>_.show=!1),type:"r",onCreateResource:A})):w("",!0),u.show?(i(),h(ne,{key:1,id:u.id,type:u.type,title:u.title,"onUpdate:show":e[3]||(e[3]=t=>u.show=!1)},null,8,["id","type","title"])):w("",!0),r.show?(i(),h(ae,{key:2,"init-name":r.initName,type:r.type,onResourceRename:U,"onUpdate:show":e[4]||(e[4]=t=>r.show=!1)},null,8,["init-name","type"])):w("",!0),y.value?(i(),h(re,{key:3,"onUpdate:show":e[5]||(e[5]=t=>y.value=!1)})):w("",!0)],64)}}});const Oe=x(be,[["__scopeId","data-v-59ffb69b"]]);export{Oe as default};
